<project name="pathVisio R package" default="build" basedir=".">
    <description>
        Build the GmmlR library and repository
    </description>

	<property name="build" location="../lib/R"/>
  	<property name="src" location="pathVisio"/>
  	<property name="fun" location="functions"/>
  
  	<property name="Rexec" value="R"/>
  
  	<condition property="isWindows">
   		<os family="windows"/>
  	</condition>
  
	<target name="prepare">
		<mkdir dir="${build}"/>
	</target>
			
	<target name="clean" description="Remove all generated files.">
		<delete dir="${build}"/>
	</target>
		
	<target name="build" depends="build-functions">
		<exec executable="${Rexec}" dir="${src}">
			<arg value="CMD"/>
			<arg value="build"/>
			<arg value="${src}"/>
		</exec>
		
		<antcall target="build-win"/>
						
		<move toDir="${build}/library">
			<fileset dir="${src}" includes="*.tar.gz"/>
			<fileset dir="${src}" includes="*.zip"/>
		</move>
	</target>
	
	<target name="build-functions" depends="prepare">
		<copy toDir="${build}/functions">
			<fileset dir="${fun}" includes="*.R"/>
		</copy>
	</target>
	
	<target name="build-win" if="isWindows">
		<exec executable="${Rexec}" dir="${src}">
			<arg value="CMD"/>
			<arg value="build"/>
			<arg value="-binary"/>
			<arg value="${src}"/>
		</exec>
	</target>
				
</project>

